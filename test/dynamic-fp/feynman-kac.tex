Due to the ineffectiveness of the physics informed method, we turn to another very useful paradigm for solving high dimensional PDEs. The Feynman-Kac formula \cite{pham2015feynman} has been used very successfully in recent years to solve high-dimensional PDEs \cite{hutzenthaler2021multilevel}. They have also been used alongside deep-learning to create algorithms for semilinear parabolic PDEs \cite{han2018solving}. Moreover, while verifying algorithms for very high dimensional PDEs one often relies on the Feynman-Kac formula to get a reference solution, see for example the examples given in sections 4, 5 of \cite{sirignano2018dgm}. The pointwise nature of the Feynman-Kac formula makes it very attractive for high-dimensional problems, since it waives the requirement for a mesh. Below we briefly discuss a few versions of the formula and the challenges associated with using it for \eqref{eq:FPE-0--dynamic-fp}.

The following version of the formula appears in \cite{oksendal2003stochastic} and it is one of the most well-known versions.
\begin{thm}[Feynman-Kac]
Suppose $f\in C^2_0(\mathbb R^d)$ and $q\in C(\mathbb R^d)$. If $q$ is bounded below then
\begin{align}
    v(t, \mathbf x) = \mathbb E\left[\left.\exp\left(-\int_0^t q(\bar X_s)\,ds\right)f(\bar X_t)\right\vert \bar X_0=\mathbf x\right]\label{eq:FK-sol--dynamic-fp}
\end{align}
is the unique solution of
\begin{equation}
\begin{aligned}
    &\frac{\partial u}{\partial t}= Au - qu\\
    & u(0, \mathbf x)=f(\mathbf x)
\end{aligned}\label{eq:FK--dynamic-fp}
\end{equation}
that's bounded on $K\times\mathbb R^d$ for every compact $K\subset[0,+\infty)$, where $\bar X_t$ is a time-homogeneous Itô process satisfying 
\begin{align}
    d\bar X_t = \bar\mu(\bar X_t)\, dt + \bar\sigma(\bar X_t)\,dW_t\label{eq:ito-time-homo--dynamic-fp}
\end{align}
with
\begin{align}
    |\bar\mu(\mathbf x)-\bar\mu(\mathbf y)| + |\bar\sigma(\mathbf x)-\bar\sigma(\mathbf y)|\le C|\mathbf x -\mathbf y|,\;\forall\,\mathbf x, \mathbf y\in\mathbb R^d\label{eq:ito-lipschitz--dynamic-fp}
\end{align}

where $C$ is a positive constant and $A$ is the infinitesimal generator of $\bar X_t$ given by 
\begin{align}
    Af = \bar\mu\cdot\nabla f + \frac{1}{2}{\rm tr}(\bar\sigma\bar\sigma^\top\odot\nabla^2f)\label{eq:ito-gen--dynamic-fp}
\end{align}
\label{thm:FK-Oksendal--dynamic-fp}\end{thm}

Note the three requirements for theorem~\ref{thm:FK-Oksendal--dynamic-fp} are global Lipschitzness of $\bar\mu$ and $\bar\sigma$, vanishing of the initial condition $f$ at infinity and the lower-boundedness of $q$. Lipschitzness of drift and diffusion coefficient ensures that SDE~\eqref{eq:ito-time-homo--dynamic-fp} has a unique, non-exploding, strong solution \cite{ikeda2014stochastic}. Vanishing of the initial condition $f$ and lower-boundedness of $q$ guarantee that the expectation in \eqref{eq:FK-sol--dynamic-fp} is bounded.

If we try to apply formula \eqref{eq:FK-sol--dynamic-fp} directly to the Fokker-Planck equation \eqref{eq:FPE-1--dynamic-fp}, we have to identify the following quantities,

\begin{equation}
\begin{aligned}
    &\bar\mu = -\mu\\
    &\bar\sigma =\sigma\\
    & q = -\nabla\cdot\mu
\end{aligned}
\end{equation}

In our examples none of the three requirements for theorem~\ref{thm:FK-Oksendal--dynamic-fp} are always satisfied. Concretely, the 2D ring system \eqref{eq:ring2D--dynamic-fp} satisfies none of the requirements. Lipschitzness of the drift is too restrictive a condition to model real world phenomena and therefore attempts have been made to relax this condition. In \cite{yamada1971uniqueness} the Lipschitz condition is replaced with Hölder condition for 1D SDEs, furthermore in \cite{fu2010stochastic}, \cite{li2011strong} sufficient conditions for existence of pathwise unique solutions of 1D SDEs have been discussed. \cite{xi2019jump} discusses the more general case when the SDEs are multi-dimensional with non-Lipschitz drifts and gives us an identical Feynman-Kac formula for \eqref{eq:FK--dynamic-fp} under the condition that \eqref{eq:ito-time-homo--dynamic-fp} has a unique, weak solution. For the sake of completeness, below we provide a special case of the more general result proved in theorem~7.5 of \cite{xi2019jump}.

\begin{thm}[Feyman-Kac with non-Lipschitz drift] Assume the following.
\begin{enumerate}
    \item \eqref{eq:ito-time-homo--dynamic-fp} has a unique weak solution.
    \item $v(\cdot,\cdot):[0, T]\times\mathbb R^d\to\mathbb R$ lies in $C^{1,2}([0, T)\times\mathbb R^d)\cap C_b([0, T]\times\mathbb R^d)$ and satisfies the Cauchy problem \eqref{eq:FK--dynamic-fp}.
    \item $f$ is uniformly bounded.
\end{enumerate}
Then $v$ is given by the formula \eqref{eq:FK-sol--dynamic-fp}.
\end{thm}







The requirement that $q$ be lower-bounded can be easily arranged while simultaneously simplifying \eqref{eq:FK-sol--dynamic-fp} by looking at an auxiliary equation. To derive this auxiliary equation we can write, 
\begin{align}
    p(t, \mathbf x) = h(t, \mathbf x)p_\infty(\mathbf x)
\end{align}
where $p_\infty$ is a nonzero zero of the operator $\mathcal L$. It is then easy to see that $h$ satisfies the equation, 
\begin{equation}
\begin{aligned}
    &h(t, \mathbf x) = (\sigma^2\nabla\log p_\infty - \mu)\cdot \nabla h + \frac{\sigma^2}{2}\Delta h,\qquad \mathbf x\in \mathbb R^d, t\in(0, T]\\
    &h(0, \mathbf x) = \frac{p_0(\mathbf x)}{p_\infty(\mathbf x)},\qquad \mathbf x\in \mathbb R^d
\end{aligned}\label{eq:h--dynamic-fp}
\end{equation}
Note that $\mathcal L$, being a linear operator, can have infinitely many distinct zeros and each such $p_\infty$ will give rise to a different PDE for $h$. If we can compute $p_\infty$ then we can compute $p$ by computing $h$. In \cite{mandal2023learning} we provide a deep learning method to compute positive zeros of $\mathcal L$ and thus for our purposes it suffices to compute $h$. To compute $h$ with the Feynman-Kac formula we identify the following quantities, 

\begin{equation}
\begin{aligned}
    &\bar\mu = (\sigma^2\nabla\log p_\infty - \mu)\\
    &\bar\sigma =\sigma\\
    & q = 0
\end{aligned}
\end{equation}

In this construction $q$ has automatically become lower-bounded. Moreover, the formula \eqref{eq:FK--dynamic-fp} simplifies to 
\begin{align}
    h(t, \mathbf x) = \mathbb E\left[\left.\frac{p_0(\bar X_t)}{p_\infty(\bar X_t)}\right\vert \bar X_0=\mathbf x\right]\label{eq:h-E--dynamic-fp}
\end{align}
where $\bar X_t$ satisfies, 
\begin{align}
    d\bar X_t = (\sigma^2\nabla\log p_\infty-\mu)\,dt + \sigma\,dW_t\label{eq:h-SDE--dynamic-fp}
\end{align}
Finally, $p(t,\mathbf x)$ can be computed with the formula, 
\begin{align}
    p(t, \mathbf x) = \mathbb E\left[\left.\frac{p_0(X_t)}{p_\infty(X_t)}\right\vert X_0=\mathbf x\right]p_\infty(\mathbf x)\label{eq:p-E--dynamic-fp}
\end{align}

Note that even if the computed $p_\infty$ is unnormalized since we both multiply and divide by $p_\infty$ in \eqref{eq:p-E--dynamic-fp}, the normalization constant cancels out. Also, since $\bar\mu$ depends on $p_\infty$ through $\nabla\log p_\infty$, the normalization constant for $p_\infty$ is again eliminated and $X_t$ appearing in \eqref{eq:p-E--dynamic-fp} is independent of the normalization constant. Therefore, we can recover the correct $p$ with \eqref{eq:p-E--dynamic-fp} for any nonzero zero of $\mathcal L$ which can be computed following the recipe laid out in \cite{mandal2023learning}. For the sake of convenience, we will refer to equations \eqref{eq:h--dynamic-fp} and \eqref{eq:h-SDE--dynamic-fp}  as the \textit{h-equation} and the \textit{h-SDE} respectively.

We have only dealt with two of the three requirements of theorem~\ref{thm:FK-Oksendal--dynamic-fp} so far by appealing to the more general version of the Feynamn-Kac formula \cite{xi2019jump} and transforming the original FPE. The remaining requirement that the initial condition vanishes at infinity translates to $\frac{p_0}{p_\infty}$ vanishing at infinity. Even though we do not impose this restriction in our examples, in section~\ref{ssec-limit--dynamic-fp} we see that this condition is immaterial to our situation since we restrict the trajectories of the h-SDE \eqref{eq:h-SDE--dynamic-fp} to a finite domain and the expectation in \eqref{eq:p-E--dynamic-fp} is therefore bounded. 


